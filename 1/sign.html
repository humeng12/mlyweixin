<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">    
<title>每日签到</title>
	<link rel="stylesheet" href="../calendar/css/bootstrap3/css/bootstrap.min.css">
	<link rel="stylesheet" href="../calendar/css/style.css">
	<link rel="stylesheet" href="../calendar/css/qiandao_style.css">
	
	<link rel="stylesheet" href="../css/weui.min.css">
	<link rel="stylesheet" href="../css/jquery-weui.min.css">
	
</head>
<body>
<div class="container">
	<div class="row">
		<div class="col-xs-12 clearPadding">
			<div class=""><img src="../images/qdBanner.jpg" class="img-responsive"></div>
			
			<div class="calendar">
				<div class="calenbox">
					<div id="calendar"></div>
				</div>
				<div class="text-center">
					<button class="btn btn-qiandao" onClick="signIn();">马上签到</button>
				</div>
			</div>
		</div>
	</div>
</div>
	<div class="maskbox"></div>
	<div class="qdbox">
		<div class="text-center text-green font18"><strong>签到成功！</strong></div>
		<div class="text-center pt10">您已经连续签到&nbsp;<span class="text-green">10</span>&nbsp;天</div>
		<div class="text-center ptb15"><img src="../images/gift.png" style="width:125px;margin-left:20px;"></div>
	</div>
	
	<script src="../calendar/js/jquery-1.10.2.min.js"></script>
	<script src="../calendar/js/calendar.js"></script>
	
	<script src="../js/jquery-weui.js"></script>
	<script src="../weui/js/weui.min.js"></script>
	<script>
		
		$(".maskbox").click(function(){
			$(".maskbox").fadeOut();
			$(".qdbox").fadeOut();
		});
		
		
		$(function(){
		  	var signList=[{"signDay":"10"},{"signDay":"11"},{"signDay":"12"},{"signDay":"13"},{"signDay":"16"}];
		   	calUtil.init(signList);
		});
		

		var datestr = getNowFormatDate();
		
		function  signIn(){

			var userid = localStorage.getItem('userid');
	
	        $.showLoading('签到中...');
	        
	        
	       	$.ajax({  
	            type:'post',  
	            url: 'http://chenxiaolong.top/shoph/1/mly/public/api/taskSign',
	            data: {
	                idstr:userid,
	                signdate:datestr
	            },
	            dataType:'json',  
	            async:false,  
	            cache:false,                 
	            success: function (result) {  
	
	                setTimeout(function() {
								
						$.hideLoading();
						$.toast(result['message'],"text");

//						$(".maskbox").fadeIn();
//						$(".qdbox").fadeIn();
//						$(".maskbox").height($(document).height());
						
					},3000); 
	            },
	            error:function(data){
	            	$.hideLoading();
	            	
	            	$.toast('签到失败',"text");
	            }
	        }); 
		}
		
		function getNowFormatDate() {

			var date = new Date();
			var seperator1 = "-";
			var seperator2 = ":";
			var month = date.getMonth() + 1;
			var strDate = date.getDate();
			if (month >= 1 && month <= 9) {
			    month = "0" + month;
			}
			if (strDate >= 0 && strDate <= 9) {
			    strDate = "0" + strDate;
			}
			var currentdate = date.getFullYear() + seperator1 + month + seperator1 + strDate;
		
			return currentdate;
		}
	</script>
</body>
</html>
